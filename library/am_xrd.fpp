module am_xrd

	implicit none

	private

contains

subroutine atom_z(atom)
	!
    implicit none
    !
    ! Cromer-Mann coefficients
    ! [a1, b1, a2, b2, a3, b3, a4, b4, c]
    select case ( trim(adjustl(to_lower(atom%atomic_symbol))) )
    	case(1);  f=[0.489918,20.6593,0.262003,7.74039,0.196767,49.5519,0.049879,2.20159,0.001305]
    	case(2);  f=[0.8734,9.1037,0.6309,3.3568,0.3112,22.9276,0.178,0.9821,0.0064]
    	case(3);  f=[1.1282,3.9546,0.7508,1.0524,0.6175,85.3905,0.4653,168.261,0.0377]
    	case(4);  f=[1.5919,43.6427,1.1278,1.8623,0.5391,103.483,0.7029,0.542,0.0385]
    	case(5);  f=[2.0545,23.2185,1.3326,1.021,1.0979,60.3498,0.7068,0.1403,0.1932]
    	case(6);  f=[2.31,20.8439,1.02,10.2075,1.5886,0.5687,0.865,51.6512,0.2156]
    	case(7);  f=[12.2126,0.0057,3.1322,9.8933,2.0125,28.9975,1.1663,0.5826,11.529]
    	case(8);  f=[3.0485,13.2771,2.2868,5.7011,1.5463,0.3239,0.867,32.9089,0.2508]
    	case(9);  f=[3.5392,10.2825,2.6412,4.2944,1.517,0.2615,1.0243,26.1476,0.2776]
    	case(10); f=[3.9553,8.4042,3.1125,3.4262,1.4546,0.2306,1.1251,21.7184,0.3515]
    	case(11); f=[4.7626,3.285,3.1736,8.8422,1.2674,0.3136,1.1128,129.424,0.676]
    	case(12); f=[5.4204,2.8275,2.1735,79.2611,1.2269,0.3808,2.3073,7.1937,0.8584]
    	case(13); f=[6.4202,3.0387,1.9002,0.7426,1.5936,31.5472,1.9646,85.0886,1.1151]
    	case(14); f=[5.66269,2.6652,3.07164,38.6634,2.62446,0.916946,1.3932,93.5458,1.24707]
    	case(15); f=[6.4345,1.9067,4.1791,27.157,1.78,0.526,1.4908,68.1645,1.1149]
    	case(16); f=[6.9053,1.4679,5.2034,22.2151,1.4379,0.2536,1.5863,56.172,0.8669]
    	case(17); f=[11.4604,0.0104,7.1964,1.1662,6.2556,18.5194,1.6455,47.7784,9.5574]
    	case(18); f=[7.4845,0.9072,6.7723,14.8407,0.6539,43.8983,1.6442,33.3929,1.4445]
    	case(19); f=[8.2186,12.7949,7.4398,0.7748,1.0519,213.187,0.8659,41.6841,1.4228]
    	case(20); f=[8.6266,10.4421,7.3873,0.6599,1.5899,85.7484,1.0211,178.437,1.3751]
    	case(21); f=[9.189,9.0213,7.3679,0.5729,1.6409,136.108,1.468,51.3531,1.3329]
    	case(22); f=[9.7595,7.8508,7.3558,0.5,1.6991,35.6338,1.9021,116.105,1.2807]
    	case(23); f=[10.2971,6.8657,7.3511,0.4385,2.0703,26.8938,2.0571,102.478,1.2199]
    	case(24); f=[10.6406,6.1038,7.3537,0.392,3.324,20.2626,1.4922,98.7399,1.1832]
    	case(25); f=[11.2819,5.3409,7.3573,0.3432,3.0193,17.8674,2.2441,83.7543,1.0896]
    	case(26); f=[11.7695,4.7611,7.3573,0.3072,3.5222,15.3535,2.3045,76.8805,1.0369]
    	case(27); f=[12.2841,4.2791,7.3409,0.2784,4.0034,13.5359,2.3488,71.1692,1.0118]
    	case(28); f=[12.8376,3.8785,7.292,0.2565,4.4438,12.1763,2.38,66.3421,1.0341]
    	case(29); f=[13.338,3.5828,7.1676,0.247,5.6158,11.3966,1.6735,64.8126,1.191]
    	case(30); f=[14.0743,3.2655,7.0318,0.2333,5.1652,10.3163,2.41,58.7097,1.3041]
    	case(31); f=[15.2354,3.0669,6.7006,0.2412,4.3591,10.7805,2.9623,61.4135,1.7189]
    	case(32); f=[16.0816,2.8509,6.3747,0.2516,3.7068,11.4468,3.683,54.7625,2.1313]
    	case(33); f=[16.6723,2.6345,6.0701,0.2647,3.4313,12.9479,4.2779,47.7972,2.531]
    	case(34); f=[17.0006,2.4098,5.8196,0.2726,3.9731,15.2372,4.3543,43.8163,2.8409]
    	case(35); f=[17.1789,2.1723,5.2358,16.5796,5.6377,0.2609,3.9851,41.4328,2.9557]
    	case(36); f=[17.3555,1.9384,6.7286,16.5623,5.5493,0.2261,3.5375,39.3972,2.825]
    	case(37); f=[17.1784,1.7888,9.6435,17.3151,5.1399,0.2748,1.5292,164.934,3.4873]
    	case(38); f=[17.5663,1.5564,9.8184,14.0988,5.422,0.1664,2.6694,132.376,2.5064]
    	case(39); f=[17.776,1.4029,10.2946,12.8006,5.72629,0.125599,3.26588,104.354,1.91213]
    	case(40); f=[17.8765,1.27618,10.948,11.916,5.41732,0.117622,3.65721,87.6627,2.06929]
    	case(41); f=[17.6142,1.18865,12.0144,11.766,4.04183,0.204785,3.53346,69.7957,3.75591]
    	case(42); f=[3.7025,0.2772,17.2356,1.0958,2.8876,11.004,3.7429,61.6584,4.3875]
    	case(43); f=[19.1301,0.864132,11.0948,8.14487,4.64901,21.5707,2.71263,86.8472,5.40428]
    	case(44); f=[19.2674,0.80852,12.9182,8.43467,4.86337,24.7997,1.56756,94.2928,5.37874]
    	case(45); f=[19.2957,0.751536,14.3501,8.21758,4.73425,25.8749,1.28918,98.6062,5.328]
    	case(46); f=[19.3319,0.698655,15.5017,7.98929,5.29537,25.2052,0.605844,76.8986,5.26593]
    	case(47); f=[19.2808,0.6446,16.6885,7.4726,4.8045,24.6605,1.0463,99.8156,5.179]
    	case(48); f=[19.2214,0.5946,17.6444,6.9089,4.461,24.7008,1.6029,87.4825,5.0694]
    	case(49); f=[19.1624,0.5476,18.5596,6.3776,4.2948,25.8499,2.0396,92.8029,4.9391]
    	case(50); f=[19.1889,5.8303,19.1005,0.5031,4.4585,26.8909,2.4663,83.9571,4.7821]
    	case(51); f=[19.6418,5.3034,19.0455,0.4607,5.0371,27.9074,2.6827,75.2825,4.5909]
    	case(52); f=[19.9644,4.81742,19.0138,0.420885,6.14487,28.5284,2.5239,70.8403,4.352]
    	case(53); f=[20.1472,4.347,18.9949,0.3814,7.5138,27.766,2.2735,66.8776,4.0712]
    	case(54); f=[20.2933,3.9282,19.0298,0.344,8.9767,26.4659,1.99,64.2658,3.7118]
    	case(55); f=[20.3892,3.569,19.1062,0.3107,0.662,24.3879,1.4953,213.904,3.3352]
    	case(56); f=[20.3361,3.216,19.297,0.2756,0.888,20.2073,2.6959,167.202,2.7731]
    	case(57); f=[20.578,2.94817,19.599,0.244475,1.3727,18.7726,3.28719,133.124,2.14678]
    	case(58); f=[21.1671,2.81219,19.7695,0.226836,1.8513,17.6083,3.33049,127.113,1.86264]
    	case(59); f=[22.044,2.77393,19.6697,0.222087,2.3856,16.7669,2.82428,143.644,2.0583]
    	case(60); f=[22.6845,2.66248,19.6847,0.210628,2.774,15.885,2.85137,137.903,1.98486]
    	case(61); f=[23.3405,2.5627,19.6095,0.202088,3.1235,15.1009,2.87516,132.721,2.02876]
    	case(62); f=[24.0042,2.47274,19.4258,0.196451,3.4396,14.3996,2.89604,128.007,2.20963]
    	case(63); f=[24.6274,2.3879,19.0886,0.1942,3.7603,13.7546,2.9227,123.174,2.5745]
    	case(64); f=[25.0709,2.25341,19.0798,0.181951,3.8518,12.9331,3.54545,101.398,2.4196]
    	case(65); f=[25.8976,2.24256,18.2185,0.196143,4.3167,12.6648,2.95354,115.362,3.58324]
    	case(66); f=[26.507,2.1802,17.6383,0.202172,4.5596,12.1899,2.96577,111.874,4.29728]
    	case(67); f=[26.9049,2.07051,17.294,0.19794,4.5583,11.4407,3.63837,92.6566,4.56796]
    	case(68); f=[27.6563,2.07356,16.4285,0.223545,4.9779,11.3604,2.98233,105.703,5.92046]
    	case(69); f=[28.1819,2.02859,15.8851,0.238849,5.1542,10.9975,2.98706,102.961,6.75621]
    	case(70); f=[28.6641,1.9889,15.4345,0.257119,5.3087,10.6647,2.98963,100.417,7.56672]
    	case(71); f=[28.9476,1.90182,15.2208,9.98519,5.1,0.261033,3.71601,84.3298,7.97628]
    	case(72); f=[29.144,1.83262,15.1726,9.5999,4.7586,0.275116,4.30013,72.029,8.58154]
    	case(73); f=[29.2024,1.77333,15.2293,9.37046,4.5135,0.295977,4.76492,63.3644,9.24354]
    	case(74); f=[29.0818,1.72029,15.43,9.2259,4.4327,0.321703,5.11982,57.056,9.8875]
    	case(75); f=[28.7621,1.67191,15.7189,9.09227,4.5564,0.3505,5.44174,52.0861,10.472]
    	case(76); f=[28.1894,1.62903,16.155,8.97948,4.9305,0.382661,5.67589,48.1647,11.0005]
    	case(77); f=[27.3049,1.59279,16.7296,8.86553,5.6115,0.417916,5.83377,45.0011,11.4722]
    	case(78); f=[27.0059,1.51293,17.7639,8.81174,5.7131,0.424593,5.7837,38.6103,11.6883]
    	case(79); f=[16.8819,0.4611,18.5913,8.6216,5.5582,1.4826,5.86,36.3956,12.0658]
    	case(80); f=[20.6809,0.545,19.0417,8.4484,1.6575,1.5729,5.9676,38.3246,12.6089]
    	case(81); f=[27.5446,0.65515,19.1584,8.70751,5.538,1.96347,5.52593,45.8149,13.1746]
    	case(82); f=[31.0617,0.6902,13.0637,2.3576,8.442,8.618,5.9696,47.2579,13.4118]
    	case(83); f=[33.3689,0.704,12.951,2.9238,6.5877,8.7937,6.4692,48.0093,13.5782]
    	case(84); f=[34.6726,0.700999,15.4733,3.55078,3.1138,9.55642,7.02588,47.0045,13.677]
    	case(85); f=[35.3163,0.68587,19.0211,3.97458,9.49887,11.3824,7.42518,45.4715,13.7108]
    	case(86); f=[35.5631,0.6631,21.2816,4.0691,8.0037,14.0422,7.4433,44.2473,13.6905]
    	case(87); f=[35.9299,0.646453,23.0547,4.17619,2.1439,23.1052,2.11253,150.645,13.7247]
    	case(88); f=[35.763,0.616341,22.9064,3.87135,2.4739,19.9887,3.21097,142.325,13.6211]
    	case(89); f=[35.6597,0.589092,23.1032,3.65155,2.5977,18.599,4.08655,117.02,13.5266]
    	case(90); f=[35.5645,0.563359,23.4219,3.46204,2.7473,17.8309,4.80703,99.1722,13.4314]
    	case(91); f=[35.8847,0.547751,23.2948,3.41519,4.1891,16.9235,4.17287,105.251,13.4287]
    	case(92); f=[36.0228,0.5293,23.4128,3.3253,4.9491,16.0927,4.188,100.613,13.3966]
    	case(93); f=[36.1874,0.511929,23.5964,3.25396,5.6402,15.3622,4.1855,97.4908,13.3573]
    	case(94); f=[36.5254,0.499384,23.8083,3.26371,6.7707,14.9455,3.47947,105.98,13.3812]
    	case(95); f=[36.6706,0.483629,24.0992,3.20647,7.3415,14.3136,3.49331,102.273,13.3592]
    	case(96); f=[36.6488,0.465154,24.4096,3.08997,7.399,13.4346,4.21665,88.4834,13.2887]
    	case(97); f=[36.7881,0.451018,24.7736,3.04619,7.8919,12.8946,4.23284,86.003,13.2754]
    	case(98); f=[36.9185,0.437533,25.1995,3.00775,8.3317,12.4044,4.24391,83.7881,13.2674]
    case default
        call am_print('ERROR','Unknown Z.')
        call am_print('Z',Z)
        stop
    end select
end subroutine

end module am_xrd