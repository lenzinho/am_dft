function [H] = get_H_model_frac(v,k)

a(1) = -(pi*(k(2) - 3*k(1) + k(3))*1i)/4;
a(2) = -(pi*(k(1) - 3*k(2) + k(3))*1i)/4;
a(3) = -(pi*(k(1) + k(2) - 3*k(3))*1i)/4;
a(4) = -(pi*(k(1) + k(2) + k(3))*1i)/4;

g(1) = exp(-a(1)) - exp(-a(2)) - exp(-a(3)) + exp(-a(4));
g(2) = exp(-a(1)) + exp(-a(2)) - exp(-a(3)) - exp(-a(4));
g(3) = exp(-a(1)) - exp(-a(2)) + exp(-a(3)) - exp(-a(4));
g(4) = exp(-a(1)) + exp(-a(2)) + exp(-a(3)) + exp(-a(4));
g(5) = exp(a(1)) - exp(a(2)) - exp(a(3)) + exp(a(4));
g(6) = exp(a(1)) + exp(a(2)) - exp(a(3)) - exp(a(4));
g(7) = exp(a(1)) - exp(a(2)) + exp(a(3)) - exp(a(4));
g(8) = exp(a(1)) + exp(a(2)) + exp(a(3)) + exp(a(4));

H = [[       v(1),       v(2),          0,          0,          0,  g(4)*v(5),  g(4)*v(6),  g(3)*v(8),  g(2)*v(8), -g(1)*v(8)];
     [       v(2),       v(3),          0,          0,          0,  g(4)*v(6),  g(4)*v(7),  g(3)*v(9),  g(2)*v(9), -g(1)*v(9)];
     [          0,          0,       v(4),          0,          0, -g(3)*v(8), -g(3)*v(9), g(4)*v(11), g(1)*v(10),-g(2)*v(10)];
     [          0,          0,          0,       v(4),          0, -g(2)*v(8), -g(2)*v(9), g(1)*v(10), g(4)*v(11),-g(3)*v(10)];
     [          0,          0,          0,          0,       v(4),  g(1)*v(8),  g(1)*v(9),-g(2)*v(10),-g(3)*v(10), g(4)*v(11)];
     [  g(8)*v(5),  g(8)*v(6), -g(7)*v(8), -g(6)*v(8),  g(5)*v(8),       v(1),       v(2),          0,          0,          0];
     [  g(8)*v(6),  g(8)*v(7), -g(7)*v(9), -g(6)*v(9),  g(5)*v(9),       v(2),       v(3),          0,          0,          0];
     [  g(7)*v(8),  g(7)*v(9), g(8)*v(11), g(5)*v(10),-g(6)*v(10),          0,          0,       v(4),          0,          0];
     [  g(6)*v(8),  g(6)*v(9), g(5)*v(10), g(8)*v(11),-g(7)*v(10),          0,          0,          0,       v(4),          0];
     [ -g(5)*v(8), -g(5)*v(9),-g(6)*v(10),-g(7)*v(10), g(8)*v(11),          0,          0,          0,          0,       v(4)]];

end