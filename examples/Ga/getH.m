function [H] = getH(pg,v,kpt)
i2pi = 2*sqrt(-1)*pi;
H(1:16,1:16) = 0;
% irreducible shell 1
H(1:4,1:4) = H(1:4,1:4) + pg.sym(1:4,1:4,1)' * getV1(v(1:4)) * pg.sym(1:4,1:4,1) * exp(i2pi*dot(kpt,[+0.00000, +0.00000, +0.00000]));
% irreducible shell 1
H(5:8,5:8) = H(5:8,5:8) + pg.sym(5:8,5:8,1)' * getV1(v(1:4)) * pg.sym(5:8,5:8,1) * exp(i2pi*dot(kpt,[+0.00000, +0.00000, +0.00000]));
% irreducible shell 1
H(9:12,9:12) = H(9:12,9:12) + pg.sym(9:12,9:12,1)' * getV1(v(1:4)) * pg.sym(9:12,9:12,1) * exp(i2pi*dot(kpt,[+0.00000, +0.00000, +0.00000]));
% irreducible shell 1
H(13:16,13:16) = H(13:16,13:16) + pg.sym(13:16,13:16,1)' * getV1(v(1:4)) * pg.sym(13:16,13:16,1) * exp(i2pi*dot(kpt,[+0.00000, +0.00000, +0.00000]));
% irreducible shell 2
H(1:4,5:8) = H(1:4,5:8) + pg.sym(1:4,1:4,1)' * getV2(v(4:10)) * pg.sym(5:8,5:8,1) * exp(i2pi*dot(kpt,[+0.00000, -2.33166, -0.70818]));
% irreducible shell 2
H(5:8,1:4) = H(5:8,1:4) + pg.sym(5:8,5:8,1)' * getV2(v(4:10))' * pg.sym(1:4,1:4,1) * exp(i2pi*dot(kpt,[+0.00000, +2.33166, +0.70818]));
% irreducible shell 2
H(9:12,13:16) = H(9:12,13:16) + pg.sym(9:12,9:12,1)' * getV2(v(4:10)) * pg.sym(13:16,13:16,1) * exp(i2pi*dot(kpt,[+0.00000, +2.33166, -0.70818]));
% irreducible shell 2
H(13:16,9:12) = H(13:16,9:12) + pg.sym(13:16,13:16,1)' * getV2(v(4:10))' * pg.sym(9:12,9:12,1) * exp(i2pi*dot(kpt,[+0.00000, -2.33166, +0.70818]));
% irreducible shell 3
H(1:4,9:12) = H(1:4,9:12) + pg.sym(1:4,1:4,1)' * getV3(v(10:16)) * pg.sym(9:12,9:12,1) * exp(i2pi*dot(kpt,[+0.00000, +1.49074, +2.25535]));
H(1:4,9:12) = H(1:4,9:12) + pg.sym(1:4,1:4,4)' * getV3(v(10:16)) * pg.sym(9:12,9:12,4) * exp(i2pi*dot(kpt,[+0.00000, +1.49074, -2.25535]));
% irreducible shell 3
H(5:8,13:16) = H(5:8,13:16) + pg.sym(5:8,5:8,1)' * getV3(v(10:16)) * pg.sym(13:16,13:16,1) * exp(i2pi*dot(kpt,[+0.00000, -1.49074, +2.25535]));
H(5:8,13:16) = H(5:8,13:16) + pg.sym(5:8,5:8,4)' * getV3(v(10:16)) * pg.sym(13:16,13:16,4) * exp(i2pi*dot(kpt,[+0.00000, -1.49074, -2.25535]));
% irreducible shell 3
H(9:12,1:4) = H(9:12,1:4) + pg.sym(9:12,9:12,1)' * getV3(v(10:16))' * pg.sym(1:4,1:4,1) * exp(i2pi*dot(kpt,[+0.00000, -1.49074, +2.25535]));
H(9:12,1:4) = H(9:12,1:4) + pg.sym(9:12,9:12,4)' * getV3(v(10:16))' * pg.sym(1:4,1:4,4) * exp(i2pi*dot(kpt,[+0.00000, -1.49074, -2.25535]));
% irreducible shell 3
H(13:16,5:8) = H(13:16,5:8) + pg.sym(13:16,13:16,1)' * getV3(v(10:16))' * pg.sym(5:8,5:8,1) * exp(i2pi*dot(kpt,[+0.00000, +1.49074, +2.25535]));
H(13:16,5:8) = H(13:16,5:8) + pg.sym(13:16,13:16,4)' * getV3(v(10:16))' * pg.sym(5:8,5:8,4) * exp(i2pi*dot(kpt,[+0.00000, +1.49074, -2.25535]));
% irreducible shell 4
H(1:4,13:16) = H(1:4,13:16) + pg.sym(1:4,1:4,1)' * getV4(v(16:22)) * pg.sym(13:16,13:16,1) * exp(i2pi*dot(kpt,[+2.25835, +0.00000, +1.54717]));
H(1:4,13:16) = H(1:4,13:16) + pg.sym(1:4,1:4,3)' * getV4(v(16:22)) * pg.sym(13:16,13:16,3) * exp(i2pi*dot(kpt,[-2.25835, +0.00000, +1.54717]));
% irreducible shell 4
H(5:8,9:12) = H(5:8,9:12) + pg.sym(5:8,5:8,1)' * getV4(v(16:22)) * pg.sym(9:12,9:12,1) * exp(i2pi*dot(kpt,[+2.25835, +0.00000, -1.54717]));
H(5:8,9:12) = H(5:8,9:12) + pg.sym(5:8,5:8,3)' * getV4(v(16:22)) * pg.sym(9:12,9:12,3) * exp(i2pi*dot(kpt,[-2.25835, +0.00000, -1.54717]));
% irreducible shell 4
H(9:12,5:8) = H(9:12,5:8) + pg.sym(9:12,9:12,1)' * getV4(v(16:22))' * pg.sym(5:8,5:8,1) * exp(i2pi*dot(kpt,[+2.25835, +0.00000, +1.54717]));
H(9:12,5:8) = H(9:12,5:8) + pg.sym(9:12,9:12,3)' * getV4(v(16:22))' * pg.sym(5:8,5:8,3) * exp(i2pi*dot(kpt,[-2.25835, +0.00000, +1.54717]));
% irreducible shell 4
H(13:16,1:4) = H(13:16,1:4) + pg.sym(13:16,13:16,1)' * getV4(v(16:22))' * pg.sym(1:4,1:4,1) * exp(i2pi*dot(kpt,[+2.25835, +0.00000, -1.54717]));
H(13:16,1:4) = H(13:16,1:4) + pg.sym(13:16,13:16,3)' * getV4(v(16:22))' * pg.sym(1:4,1:4,3) * exp(i2pi*dot(kpt,[-2.25835, +0.00000, -1.54717]));
% irreducible shell 5
H(1:4,5:8) = H(1:4,5:8) + pg.sym(1:4,1:4,1)' * getV5(v(22:31)) * pg.sym(5:8,5:8,1) * exp(i2pi*dot(kpt,[-2.25835, +1.49074, -0.70818]));
H(1:4,5:8) = H(1:4,5:8) + pg.sym(1:4,1:4,8)' * getV5(v(22:31)) * pg.sym(5:8,5:8,8) * exp(i2pi*dot(kpt,[+2.25835, +1.49074, -0.70818]));
% irreducible shell 5
H(5:8,1:4) = H(5:8,1:4) + pg.sym(5:8,5:8,1)' * getV5(v(22:31))' * pg.sym(1:4,1:4,1) * exp(i2pi*dot(kpt,[-2.25835, -1.49074, +0.70818]));
H(5:8,1:4) = H(5:8,1:4) + pg.sym(5:8,5:8,8)' * getV5(v(22:31))' * pg.sym(1:4,1:4,8) * exp(i2pi*dot(kpt,[+2.25835, -1.49074, +0.70818]));
% irreducible shell 5
H(9:12,13:16) = H(9:12,13:16) + pg.sym(9:12,9:12,1)' * getV5(v(22:31)) * pg.sym(13:16,13:16,1) * exp(i2pi*dot(kpt,[+2.25835, -1.49074, -0.70818]));
H(9:12,13:16) = H(9:12,13:16) + pg.sym(9:12,9:12,8)' * getV5(v(22:31)) * pg.sym(13:16,13:16,8) * exp(i2pi*dot(kpt,[-2.25835, -1.49074, -0.70818]));
% irreducible shell 5
H(13:16,9:12) = H(13:16,9:12) + pg.sym(13:16,13:16,1)' * getV5(v(22:31))' * pg.sym(9:12,9:12,1) * exp(i2pi*dot(kpt,[+2.25835, +1.49074, +0.70818]));
H(13:16,9:12) = H(13:16,9:12) + pg.sym(13:16,13:16,8)' * getV5(v(22:31))' * pg.sym(9:12,9:12,8) * exp(i2pi*dot(kpt,[-2.25835, +1.49074, +0.70818]));
% irreducible shell 6
H(1:4,13:16) = H(1:4,13:16) + pg.sym(1:4,1:4,1)' * getV6(v(31:37)) * pg.sym(13:16,13:16,1) * exp(i2pi*dot(kpt,[+2.25835, +0.00000, -2.96353]));
H(1:4,13:16) = H(1:4,13:16) + pg.sym(1:4,1:4,3)' * getV6(v(31:37)) * pg.sym(13:16,13:16,3) * exp(i2pi*dot(kpt,[-2.25835, +0.00000, -2.96353]));
% irreducible shell 6
H(5:8,9:12) = H(5:8,9:12) + pg.sym(5:8,5:8,1)' * getV6(v(31:37)) * pg.sym(9:12,9:12,1) * exp(i2pi*dot(kpt,[+2.25835, +0.00000, +2.96353]));
H(5:8,9:12) = H(5:8,9:12) + pg.sym(5:8,5:8,3)' * getV6(v(31:37)) * pg.sym(9:12,9:12,3) * exp(i2pi*dot(kpt,[-2.25835, +0.00000, +2.96353]));
% irreducible shell 6
H(9:12,5:8) = H(9:12,5:8) + pg.sym(9:12,9:12,1)' * getV6(v(31:37))' * pg.sym(5:8,5:8,1) * exp(i2pi*dot(kpt,[+2.25835, +0.00000, -2.96353]));
H(9:12,5:8) = H(9:12,5:8) + pg.sym(9:12,9:12,3)' * getV6(v(31:37))' * pg.sym(5:8,5:8,3) * exp(i2pi*dot(kpt,[-2.25835, +0.00000, -2.96353]));
% irreducible shell 6
H(13:16,1:4) = H(13:16,1:4) + pg.sym(13:16,13:16,1)' * getV6(v(31:37))' * pg.sym(1:4,1:4,1) * exp(i2pi*dot(kpt,[+2.25835, +0.00000, +2.96353]));
H(13:16,1:4) = H(13:16,1:4) + pg.sym(13:16,13:16,3)' * getV6(v(31:37))' * pg.sym(1:4,1:4,3) * exp(i2pi*dot(kpt,[-2.25835, +0.00000, +2.96353]));
% irreducible shell 7
H(1:4,9:12) = H(1:4,9:12) + pg.sym(1:4,1:4,1)' * getV7(v(37:46)) * pg.sym(9:12,9:12,1) * exp(i2pi*dot(kpt,[+2.25835, -2.33166, +2.25535]));
H(1:4,9:12) = H(1:4,9:12) + pg.sym(1:4,1:4,8)' * getV7(v(37:46)) * pg.sym(9:12,9:12,8) * exp(i2pi*dot(kpt,[-2.25835, -2.33166, +2.25535]));
H(1:4,9:12) = H(1:4,9:12) + pg.sym(1:4,1:4,7)' * getV7(v(37:46)) * pg.sym(9:12,9:12,7) * exp(i2pi*dot(kpt,[+2.25835, -2.33166, -2.25535]));
H(1:4,9:12) = H(1:4,9:12) + pg.sym(1:4,1:4,4)' * getV7(v(37:46)) * pg.sym(9:12,9:12,4) * exp(i2pi*dot(kpt,[-2.25835, -2.33166, -2.25535]));
% irreducible shell 7
H(5:8,13:16) = H(5:8,13:16) + pg.sym(5:8,5:8,1)' * getV7(v(37:46)) * pg.sym(13:16,13:16,1) * exp(i2pi*dot(kpt,[+2.25835, +2.33166, +2.25535]));
H(5:8,13:16) = H(5:8,13:16) + pg.sym(5:8,5:8,8)' * getV7(v(37:46)) * pg.sym(13:16,13:16,8) * exp(i2pi*dot(kpt,[-2.25835, +2.33166, +2.25535]));
H(5:8,13:16) = H(5:8,13:16) + pg.sym(5:8,5:8,7)' * getV7(v(37:46)) * pg.sym(13:16,13:16,7) * exp(i2pi*dot(kpt,[+2.25835, +2.33166, -2.25535]));
H(5:8,13:16) = H(5:8,13:16) + pg.sym(5:8,5:8,4)' * getV7(v(37:46)) * pg.sym(13:16,13:16,4) * exp(i2pi*dot(kpt,[-2.25835, +2.33166, -2.25535]));
% irreducible shell 7
H(9:12,1:4) = H(9:12,1:4) + pg.sym(9:12,9:12,1)' * getV7(v(37:46))' * pg.sym(1:4,1:4,1) * exp(i2pi*dot(kpt,[+2.25835, +2.33166, +2.25535]));
H(9:12,1:4) = H(9:12,1:4) + pg.sym(9:12,9:12,8)' * getV7(v(37:46))' * pg.sym(1:4,1:4,8) * exp(i2pi*dot(kpt,[-2.25835, +2.33166, +2.25535]));
H(9:12,1:4) = H(9:12,1:4) + pg.sym(9:12,9:12,7)' * getV7(v(37:46))' * pg.sym(1:4,1:4,7) * exp(i2pi*dot(kpt,[+2.25835, +2.33166, -2.25535]));
H(9:12,1:4) = H(9:12,1:4) + pg.sym(9:12,9:12,4)' * getV7(v(37:46))' * pg.sym(1:4,1:4,4) * exp(i2pi*dot(kpt,[-2.25835, +2.33166, -2.25535]));
% irreducible shell 7
H(13:16,5:8) = H(13:16,5:8) + pg.sym(13:16,13:16,1)' * getV7(v(37:46))' * pg.sym(5:8,5:8,1) * exp(i2pi*dot(kpt,[+2.25835, -2.33166, +2.25535]));
H(13:16,5:8) = H(13:16,5:8) + pg.sym(13:16,13:16,8)' * getV7(v(37:46))' * pg.sym(5:8,5:8,8) * exp(i2pi*dot(kpt,[-2.25835, -2.33166, +2.25535]));
H(13:16,5:8) = H(13:16,5:8) + pg.sym(13:16,13:16,7)' * getV7(v(37:46))' * pg.sym(5:8,5:8,7) * exp(i2pi*dot(kpt,[+2.25835, -2.33166, -2.25535]));
H(13:16,5:8) = H(13:16,5:8) + pg.sym(13:16,13:16,4)' * getV7(v(37:46))' * pg.sym(5:8,5:8,4) * exp(i2pi*dot(kpt,[-2.25835, -2.33166, -2.25535]));
% irreducible shell 8
H(1:4,13:16) = H(1:4,13:16) + pg.sym(1:4,1:4,1)' * getV8(v(46:52)) * pg.sym(13:16,13:16,1) * exp(i2pi*dot(kpt,[+0.00000, -3.82240, +1.54717]));
H(1:4,13:16) = H(1:4,13:16) + pg.sym(1:4,1:4,3)' * getV8(v(46:52)) * pg.sym(13:16,13:16,3) * exp(i2pi*dot(kpt,[+0.00000, +3.82240, +1.54717]));
% irreducible shell 8
H(5:8,9:12) = H(5:8,9:12) + pg.sym(5:8,5:8,1)' * getV8(v(46:52)) * pg.sym(9:12,9:12,1) * exp(i2pi*dot(kpt,[+0.00000, +3.82240, -1.54717]));
H(5:8,9:12) = H(5:8,9:12) + pg.sym(5:8,5:8,3)' * getV8(v(46:52)) * pg.sym(9:12,9:12,3) * exp(i2pi*dot(kpt,[+0.00000, -3.82240, -1.54717]));
% irreducible shell 8
H(9:12,5:8) = H(9:12,5:8) + pg.sym(9:12,9:12,1)' * getV8(v(46:52))' * pg.sym(5:8,5:8,1) * exp(i2pi*dot(kpt,[+0.00000, -3.82240, +1.54717]));
H(9:12,5:8) = H(9:12,5:8) + pg.sym(9:12,9:12,3)' * getV8(v(46:52))' * pg.sym(5:8,5:8,3) * exp(i2pi*dot(kpt,[+0.00000, +3.82240, +1.54717]));
% irreducible shell 8
H(13:16,1:4) = H(13:16,1:4) + pg.sym(13:16,13:16,1)' * getV8(v(46:52))' * pg.sym(1:4,1:4,1) * exp(i2pi*dot(kpt,[+0.00000, +3.82240, -1.54717]));
H(13:16,1:4) = H(13:16,1:4) + pg.sym(13:16,13:16,3)' * getV8(v(46:52))' * pg.sym(1:4,1:4,3) * exp(i2pi*dot(kpt,[+0.00000, -3.82240, -1.54717]));
end
