function [H] = getH(pg,v,kpt)
i2pi = 2*sqrt(-1)*pi;
H(1:16,1:16) = 0;
% irreducible shell 1
H(1:8,1:8) = H(1:8,1:8) + pg.sym(1:8,1:8,1)' * getV1(v(1:3)) * pg.sym(1:8,1:8,1) * exp(i2pi*dot(kpt,[+0.00000, +0.00000, +0.00000]));
% irreducible shell 1
H(9:16,9:16) = H(9:16,9:16) + pg.sym(9:16,9:16,1)' * getV1(v(1:3)) * pg.sym(9:16,9:16,1) * exp(i2pi*dot(kpt,[+0.00000, +0.00000, +0.00000]));
% irreducible shell 2
H(1:8,9:16) = H(1:8,9:16) + pg.sym(1:8,1:8,1)' * getV2(v(3:11)) * pg.sym(9:16,9:16,1) * exp(i2pi*dot(kpt,[-1.35750, -1.35750, +1.35750]));
H(1:8,9:16) = H(1:8,9:16) + pg.sym(1:8,1:8,3)' * getV2(v(3:11)) * pg.sym(9:16,9:16,3) * exp(i2pi*dot(kpt,[+1.35750, +1.35750, +1.35750]));
H(1:8,9:16) = H(1:8,9:16) + pg.sym(1:8,1:8,4)' * getV2(v(3:11)) * pg.sym(9:16,9:16,4) * exp(i2pi*dot(kpt,[+1.35750, -1.35750, -1.35750]));
H(1:8,9:16) = H(1:8,9:16) + pg.sym(1:8,1:8,2)' * getV2(v(3:11)) * pg.sym(9:16,9:16,2) * exp(i2pi*dot(kpt,[-1.35750, +1.35750, -1.35750]));
% irreducible shell 2
H(9:16,1:8) = H(9:16,1:8) + pg.sym(9:16,9:16,1)' * getV2(v(3:11))' * pg.sym(1:8,1:8,1) * exp(i2pi*dot(kpt,[+1.35750, -1.35750, +1.35750]));
H(9:16,1:8) = H(9:16,1:8) + pg.sym(9:16,9:16,3)' * getV2(v(3:11))' * pg.sym(1:8,1:8,3) * exp(i2pi*dot(kpt,[-1.35750, +1.35750, +1.35750]));
H(9:16,1:8) = H(9:16,1:8) + pg.sym(9:16,9:16,4)' * getV2(v(3:11))' * pg.sym(1:8,1:8,4) * exp(i2pi*dot(kpt,[-1.35750, -1.35750, -1.35750]));
H(9:16,1:8) = H(9:16,1:8) + pg.sym(9:16,9:16,2)' * getV2(v(3:11))' * pg.sym(1:8,1:8,2) * exp(i2pi*dot(kpt,[+1.35750, +1.35750, -1.35750]));
end
