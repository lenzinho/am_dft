function [H] = getH(pg,v,kpt)
i2pi = 2*sqrt(-1)*pi;
H(1:8,1:8) = 0;
% irreducible shell 1
H(1:3,1:3) = H(1:3,1:3) + pg.sym(1:3,1:3,1)' * getV1(v(1:1)) * pg.sym(1:3,1:3,1) * exp(i2pi*dot(kpt,[+0.00000, +0.00000, +0.00000]));
% irreducible shell 2
H(1:3,4:8) = H(1:3,4:8) + pg.sym(1:3,1:3,1)' * getV2(v(1:3)) * pg.sym(4:8,4:8,1) * exp(i2pi*dot(kpt,[+1.43755, -1.43755, +1.43755]));
H(1:3,4:8) = H(1:3,4:8) + pg.sym(1:3,1:3,3)' * getV2(v(1:3)) * pg.sym(4:8,4:8,3) * exp(i2pi*dot(kpt,[-1.43755, +1.43755, +1.43755]));
H(1:3,4:8) = H(1:3,4:8) + pg.sym(1:3,1:3,2)' * getV2(v(1:3)) * pg.sym(4:8,4:8,2) * exp(i2pi*dot(kpt,[-1.43755, -1.43755, -1.43755]));
H(1:3,4:8) = H(1:3,4:8) + pg.sym(1:3,1:3,4)' * getV2(v(1:3)) * pg.sym(4:8,4:8,4) * exp(i2pi*dot(kpt,[+1.43755, +1.43755, -1.43755]));
% irreducible shell 2
H(4:8,1:3) = H(4:8,1:3) + pg.sym(4:8,4:8,1)' * getV2(v(1:3))' * pg.sym(1:3,1:3,1) * exp(i2pi*dot(kpt,[-1.43755, -1.43755, +1.43755]));
H(4:8,1:3) = H(4:8,1:3) + pg.sym(4:8,4:8,3)' * getV2(v(1:3))' * pg.sym(1:3,1:3,3) * exp(i2pi*dot(kpt,[+1.43755, +1.43755, +1.43755]));
H(4:8,1:3) = H(4:8,1:3) + pg.sym(4:8,4:8,2)' * getV2(v(1:3))' * pg.sym(1:3,1:3,2) * exp(i2pi*dot(kpt,[+1.43755, -1.43755, -1.43755]));
H(4:8,1:3) = H(4:8,1:3) + pg.sym(4:8,4:8,4)' * getV2(v(1:3))' * pg.sym(1:3,1:3,4) * exp(i2pi*dot(kpt,[-1.43755, +1.43755, -1.43755]));
% irreducible shell 3
H(1:3,1:3) = H(1:3,1:3) + pg.sym(1:3,1:3,1)' * getV3(v(3:6)) * pg.sym(1:3,1:3,1) * exp(i2pi*dot(kpt,[+0.00000, -2.87509, +2.87509]));
H(1:3,1:3) = H(1:3,1:3) + pg.sym(1:3,1:3,5)' * getV3(v(3:6)) * pg.sym(1:3,1:3,5) * exp(i2pi*dot(kpt,[+2.87509, +0.00000, +2.87509]));
H(1:3,1:3) = H(1:3,1:3) + pg.sym(1:3,1:3,9)' * getV3(v(3:6)) * pg.sym(1:3,1:3,9) * exp(i2pi*dot(kpt,[-2.87509, +0.00000, +2.87509]));
H(1:3,1:3) = H(1:3,1:3) + pg.sym(1:3,1:3,3)' * getV3(v(3:6)) * pg.sym(1:3,1:3,3) * exp(i2pi*dot(kpt,[+0.00000, +2.87509, +2.87509]));
H(1:3,1:3) = H(1:3,1:3) + pg.sym(1:3,1:3,7)' * getV3(v(3:6)) * pg.sym(1:3,1:3,7) * exp(i2pi*dot(kpt,[+2.87509, -2.87509, +0.00000]));
H(1:3,1:3) = H(1:3,1:3) + pg.sym(1:3,1:3,6)' * getV3(v(3:6)) * pg.sym(1:3,1:3,6) * exp(i2pi*dot(kpt,[-2.87509, -2.87509, +0.00000]));
H(1:3,1:3) = H(1:3,1:3) + pg.sym(1:3,1:3,11)' * getV3(v(3:6)) * pg.sym(1:3,1:3,11) * exp(i2pi*dot(kpt,[+2.87509, +2.87509, +0.00000]));
H(1:3,1:3) = H(1:3,1:3) + pg.sym(1:3,1:3,10)' * getV3(v(3:6)) * pg.sym(1:3,1:3,10) * exp(i2pi*dot(kpt,[-2.87509, +2.87509, +0.00000]));
H(1:3,1:3) = H(1:3,1:3) + pg.sym(1:3,1:3,2)' * getV3(v(3:6)) * pg.sym(1:3,1:3,2) * exp(i2pi*dot(kpt,[+0.00000, -2.87509, -2.87509]));
H(1:3,1:3) = H(1:3,1:3) + pg.sym(1:3,1:3,8)' * getV3(v(3:6)) * pg.sym(1:3,1:3,8) * exp(i2pi*dot(kpt,[+2.87509, +0.00000, -2.87509]));
H(1:3,1:3) = H(1:3,1:3) + pg.sym(1:3,1:3,12)' * getV3(v(3:6)) * pg.sym(1:3,1:3,12) * exp(i2pi*dot(kpt,[-2.87509, +0.00000, -2.87509]));
H(1:3,1:3) = H(1:3,1:3) + pg.sym(1:3,1:3,4)' * getV3(v(3:6)) * pg.sym(1:3,1:3,4) * exp(i2pi*dot(kpt,[+0.00000, +2.87509, -2.87509]));
% irreducible shell 4
H(1:3,4:8) = H(1:3,4:8) + pg.sym(1:3,1:3,1)' * getV4(v(6:13)) * pg.sym(4:8,4:8,1) * exp(i2pi*dot(kpt,[-1.43755, -1.43755, +4.31264]));
H(1:3,4:8) = H(1:3,4:8) + pg.sym(1:3,1:3,3)' * getV4(v(6:13)) * pg.sym(4:8,4:8,3) * exp(i2pi*dot(kpt,[+1.43755, +1.43755, +4.31264]));
H(1:3,4:8) = H(1:3,4:8) + pg.sym(1:3,1:3,6)' * getV4(v(6:13)) * pg.sym(4:8,4:8,6) * exp(i2pi*dot(kpt,[-1.43755, -4.31264, +1.43755]));
H(1:3,4:8) = H(1:3,4:8) + pg.sym(1:3,1:3,9)' * getV4(v(6:13)) * pg.sym(4:8,4:8,9) * exp(i2pi*dot(kpt,[-4.31264, -1.43755, +1.43755]));
H(1:3,4:8) = H(1:3,4:8) + pg.sym(1:3,1:3,5)' * getV4(v(6:13)) * pg.sym(4:8,4:8,5) * exp(i2pi*dot(kpt,[+4.31264, +1.43755, +1.43755]));
H(1:3,4:8) = H(1:3,4:8) + pg.sym(1:3,1:3,11)' * getV4(v(6:13)) * pg.sym(4:8,4:8,11) * exp(i2pi*dot(kpt,[+1.43755, +4.31264, +1.43755]));
H(1:3,4:8) = H(1:3,4:8) + pg.sym(1:3,1:3,7)' * getV4(v(6:13)) * pg.sym(4:8,4:8,7) * exp(i2pi*dot(kpt,[+1.43755, -4.31264, -1.43755]));
H(1:3,4:8) = H(1:3,4:8) + pg.sym(1:3,1:3,8)' * getV4(v(6:13)) * pg.sym(4:8,4:8,8) * exp(i2pi*dot(kpt,[+4.31264, -1.43755, -1.43755]));
H(1:3,4:8) = H(1:3,4:8) + pg.sym(1:3,1:3,12)' * getV4(v(6:13)) * pg.sym(4:8,4:8,12) * exp(i2pi*dot(kpt,[-4.31264, +1.43755, -1.43755]));
H(1:3,4:8) = H(1:3,4:8) + pg.sym(1:3,1:3,10)' * getV4(v(6:13)) * pg.sym(4:8,4:8,10) * exp(i2pi*dot(kpt,[-1.43755, +4.31264, -1.43755]));
H(1:3,4:8) = H(1:3,4:8) + pg.sym(1:3,1:3,2)' * getV4(v(6:13)) * pg.sym(4:8,4:8,2) * exp(i2pi*dot(kpt,[+1.43755, -1.43755, -4.31264]));
H(1:3,4:8) = H(1:3,4:8) + pg.sym(1:3,1:3,4)' * getV4(v(6:13)) * pg.sym(4:8,4:8,4) * exp(i2pi*dot(kpt,[-1.43755, +1.43755, -4.31264]));
% irreducible shell 4
H(4:8,1:3) = H(4:8,1:3) + pg.sym(4:8,4:8,1)' * getV4(v(6:13))' * pg.sym(1:3,1:3,1) * exp(i2pi*dot(kpt,[+1.43755, -1.43755, +4.31264]));
H(4:8,1:3) = H(4:8,1:3) + pg.sym(4:8,4:8,3)' * getV4(v(6:13))' * pg.sym(1:3,1:3,3) * exp(i2pi*dot(kpt,[-1.43755, +1.43755, +4.31264]));
H(4:8,1:3) = H(4:8,1:3) + pg.sym(4:8,4:8,7)' * getV4(v(6:13))' * pg.sym(1:3,1:3,7) * exp(i2pi*dot(kpt,[+1.43755, -4.31264, +1.43755]));
H(4:8,1:3) = H(4:8,1:3) + pg.sym(4:8,4:8,5)' * getV4(v(6:13))' * pg.sym(1:3,1:3,5) * exp(i2pi*dot(kpt,[+4.31264, -1.43755, +1.43755]));
H(4:8,1:3) = H(4:8,1:3) + pg.sym(4:8,4:8,9)' * getV4(v(6:13))' * pg.sym(1:3,1:3,9) * exp(i2pi*dot(kpt,[-4.31264, +1.43755, +1.43755]));
H(4:8,1:3) = H(4:8,1:3) + pg.sym(4:8,4:8,10)' * getV4(v(6:13))' * pg.sym(1:3,1:3,10) * exp(i2pi*dot(kpt,[-1.43755, +4.31264, +1.43755]));
H(4:8,1:3) = H(4:8,1:3) + pg.sym(4:8,4:8,6)' * getV4(v(6:13))' * pg.sym(1:3,1:3,6) * exp(i2pi*dot(kpt,[-1.43755, -4.31264, -1.43755]));
H(4:8,1:3) = H(4:8,1:3) + pg.sym(4:8,4:8,12)' * getV4(v(6:13))' * pg.sym(1:3,1:3,12) * exp(i2pi*dot(kpt,[-4.31264, -1.43755, -1.43755]));
H(4:8,1:3) = H(4:8,1:3) + pg.sym(4:8,4:8,8)' * getV4(v(6:13))' * pg.sym(1:3,1:3,8) * exp(i2pi*dot(kpt,[+4.31264, +1.43755, -1.43755]));
H(4:8,1:3) = H(4:8,1:3) + pg.sym(4:8,4:8,11)' * getV4(v(6:13))' * pg.sym(1:3,1:3,11) * exp(i2pi*dot(kpt,[+1.43755, +4.31264, -1.43755]));
H(4:8,1:3) = H(4:8,1:3) + pg.sym(4:8,4:8,2)' * getV4(v(6:13))' * pg.sym(1:3,1:3,2) * exp(i2pi*dot(kpt,[-1.43755, -1.43755, -4.31264]));
H(4:8,1:3) = H(4:8,1:3) + pg.sym(4:8,4:8,4)' * getV4(v(6:13))' * pg.sym(1:3,1:3,4) * exp(i2pi*dot(kpt,[+1.43755, +1.43755, -4.31264]));
% irreducible shell 5
H(4:8,4:8) = H(4:8,4:8) + pg.sym(4:8,4:8,1)' * getV5(v(13:14)) * pg.sym(4:8,4:8,1) * exp(i2pi*dot(kpt,[+0.00000, +0.00000, +0.00000]));
% irreducible shell 6
H(4:8,4:8) = H(4:8,4:8) + pg.sym(4:8,4:8,1)' * getV6(v(14:22)) * pg.sym(4:8,4:8,1) * exp(i2pi*dot(kpt,[+0.00000, -2.87509, +2.87509]));
H(4:8,4:8) = H(4:8,4:8) + pg.sym(4:8,4:8,5)' * getV6(v(14:22)) * pg.sym(4:8,4:8,5) * exp(i2pi*dot(kpt,[+2.87509, +0.00000, +2.87509]));
H(4:8,4:8) = H(4:8,4:8) + pg.sym(4:8,4:8,9)' * getV6(v(14:22)) * pg.sym(4:8,4:8,9) * exp(i2pi*dot(kpt,[-2.87509, +0.00000, +2.87509]));
H(4:8,4:8) = H(4:8,4:8) + pg.sym(4:8,4:8,3)' * getV6(v(14:22)) * pg.sym(4:8,4:8,3) * exp(i2pi*dot(kpt,[+0.00000, +2.87509, +2.87509]));
H(4:8,4:8) = H(4:8,4:8) + pg.sym(4:8,4:8,7)' * getV6(v(14:22)) * pg.sym(4:8,4:8,7) * exp(i2pi*dot(kpt,[+2.87509, -2.87509, +0.00000]));
H(4:8,4:8) = H(4:8,4:8) + pg.sym(4:8,4:8,6)' * getV6(v(14:22)) * pg.sym(4:8,4:8,6) * exp(i2pi*dot(kpt,[-2.87509, -2.87509, +0.00000]));
H(4:8,4:8) = H(4:8,4:8) + pg.sym(4:8,4:8,11)' * getV6(v(14:22)) * pg.sym(4:8,4:8,11) * exp(i2pi*dot(kpt,[+2.87509, +2.87509, +0.00000]));
H(4:8,4:8) = H(4:8,4:8) + pg.sym(4:8,4:8,10)' * getV6(v(14:22)) * pg.sym(4:8,4:8,10) * exp(i2pi*dot(kpt,[-2.87509, +2.87509, +0.00000]));
H(4:8,4:8) = H(4:8,4:8) + pg.sym(4:8,4:8,2)' * getV6(v(14:22)) * pg.sym(4:8,4:8,2) * exp(i2pi*dot(kpt,[+0.00000, -2.87509, -2.87509]));
H(4:8,4:8) = H(4:8,4:8) + pg.sym(4:8,4:8,8)' * getV6(v(14:22)) * pg.sym(4:8,4:8,8) * exp(i2pi*dot(kpt,[+2.87509, +0.00000, -2.87509]));
H(4:8,4:8) = H(4:8,4:8) + pg.sym(4:8,4:8,12)' * getV6(v(14:22)) * pg.sym(4:8,4:8,12) * exp(i2pi*dot(kpt,[-2.87509, +0.00000, -2.87509]));
H(4:8,4:8) = H(4:8,4:8) + pg.sym(4:8,4:8,4)' * getV6(v(14:22)) * pg.sym(4:8,4:8,4) * exp(i2pi*dot(kpt,[+0.00000, +2.87509, -2.87509]));
end
