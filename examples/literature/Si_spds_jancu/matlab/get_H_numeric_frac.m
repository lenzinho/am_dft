function [H] = get_H_numeric_frac(pg,v,kpt,shell)
i2pi = 2*sqrt(-1)*pi;
H(1:8,1:8) = 0;
if any(shell==1)
H(1:4,1:4) = H(1:4,1:4) + pg.sym(1:4,1:4,1)' * getV1(v(1:2)) * pg.sym(1:4,1:4,1) * exp(i2pi*dot(kpt,[+0.00000, +0.00000, +0.00000]));
H(5:8,5:8) = H(5:8,5:8) + pg.sym(5:8,5:8,1)' * getV1(v(1:2)) * pg.sym(5:8,5:8,1) * exp(i2pi*dot(kpt,[+0.00000, +0.00000, +0.00000]));
end
if any(shell==2)
H(1:4,5:8) = H(1:4,5:8) + pg.sym(1:4,1:4,1)' * getV2(v(3:6)) * pg.sym(5:8,5:8,1) * exp(i2pi*dot(kpt,[+0.25000, -0.75000, +0.25000]));
H(1:4,5:8) = H(1:4,5:8) + pg.sym(1:4,1:4,4)' * getV2(v(3:6)) * pg.sym(5:8,5:8,4) * exp(i2pi*dot(kpt,[+0.25000, +0.25000, -0.75000]));
H(1:4,5:8) = H(1:4,5:8) + pg.sym(1:4,1:4,3)' * getV2(v(3:6)) * pg.sym(5:8,5:8,3) * exp(i2pi*dot(kpt,[-0.75000, +0.25000, +0.25000]));
H(1:4,5:8) = H(1:4,5:8) + pg.sym(1:4,1:4,2)' * getV2(v(3:6)) * pg.sym(5:8,5:8,2) * exp(i2pi*dot(kpt,[+0.25000, +0.25000, +0.25000]));
H(5:8,1:4) = H(5:8,1:4) + pg.sym(5:8,5:8,1)' * getV2(v(3:6))' * pg.sym(1:4,1:4,1) * exp(i2pi*dot(kpt,[-0.25000, +0.75000, -0.25000]));
H(5:8,1:4) = H(5:8,1:4) + pg.sym(5:8,5:8,4)' * getV2(v(3:6))' * pg.sym(1:4,1:4,4) * exp(i2pi*dot(kpt,[-0.25000, -0.25000, +0.75000]));
H(5:8,1:4) = H(5:8,1:4) + pg.sym(5:8,5:8,3)' * getV2(v(3:6))' * pg.sym(1:4,1:4,3) * exp(i2pi*dot(kpt,[+0.75000, -0.25000, -0.25000]));
H(5:8,1:4) = H(5:8,1:4) + pg.sym(5:8,5:8,2)' * getV2(v(3:6))' * pg.sym(1:4,1:4,2) * exp(i2pi*dot(kpt,[-0.25000, -0.25000, -0.25000]));
end
end
function [a] = getV1(v)
a(1,1) = v(1);
a(4,4) = v(2);
a(2,2) = +1.0000000000000000*a(4,4);
a(3,3) = +1.0000000000000000*a(4,4);
a(2,1) = 0;
a(3,1) = 0;
a(4,1) = 0;
a(1,2) = 0;
a(3,2) = 0;
a(4,2) = 0;
a(1,3) = 0;
a(2,3) = 0;
a(4,3) = 0;
a(1,4) = 0;
a(2,4) = 0;
a(3,4) = 0;
end
function [a] = getV2(v)
a(1,1) = v(1);
a(1,4) = v(2);
a(3,4) = v(3);
a(4,4) = v(4);
a(2,1) = +1.0000000000000000*a(1,4);
a(3,1) = -1.0000000000000000*a(1,4);
a(4,1) = -1.0000000000000000*a(1,4);
a(1,2) = -1.0000000000000000*a(1,4);
a(2,2) = +1.0000000000000000*a(4,4);
a(3,2) = -1.0000000000000000*a(3,4);
a(4,2) = -1.0000000000000000*a(3,4);
a(1,3) = +1.0000000000000000*a(1,4);
a(2,3) = -1.0000000000000000*a(3,4);
a(3,3) = +1.0000000000000000*a(4,4);
a(4,3) = +1.0000000000000000*a(3,4);
a(2,4) = -1.0000000000000000*a(3,4);
end
