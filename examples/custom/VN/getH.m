function [H] = getH(pg,v,kpt)
i2pi = 2*sqrt(-1)*pi;
H(1:6,1:6) = 0;
% irreducible shell 1
H(1:3,1:3) = H(1:3,1:3) + pg.sym(1:3,1:3,1)' * getV1(v(1:1)) * pg.sym(1:3,1:3,1) * exp(i2pi*dot(kpt,[+0.00000, +0.00000, +0.00000]));
% irreducible shell 2
H(1:3,4:6) = H(1:3,4:6) + pg.sym(1:3,1:3,1)' * getV2(v(1:2)) * pg.sym(4:6,4:6,1) * exp(i2pi*dot(kpt,[+0.00000, +0.00000, +2.03524]));
H(1:3,4:6) = H(1:3,4:6) + pg.sym(1:3,1:3,8)' * getV2(v(1:2)) * pg.sym(4:6,4:6,8) * exp(i2pi*dot(kpt,[+0.00000, -2.03524, +0.00000]));
H(1:3,4:6) = H(1:3,4:6) + pg.sym(1:3,1:3,7)' * getV2(v(1:2)) * pg.sym(4:6,4:6,7) * exp(i2pi*dot(kpt,[+2.03524, +0.00000, +0.00000]));
H(1:3,4:6) = H(1:3,4:6) + pg.sym(1:3,1:3,9)' * getV2(v(1:2)) * pg.sym(4:6,4:6,9) * exp(i2pi*dot(kpt,[-2.03524, +0.00000, +0.00000]));
H(1:3,4:6) = H(1:3,4:6) + pg.sym(1:3,1:3,5)' * getV2(v(1:2)) * pg.sym(4:6,4:6,5) * exp(i2pi*dot(kpt,[+0.00000, +2.03524, +0.00000]));
H(1:3,4:6) = H(1:3,4:6) + pg.sym(1:3,1:3,2)' * getV2(v(1:2)) * pg.sym(4:6,4:6,2) * exp(i2pi*dot(kpt,[+0.00000, +0.00000, -2.03524]));
% irreducible shell 2
H(4:6,1:3) = H(4:6,1:3) + pg.sym(4:6,4:6,1)' * getV2(v(1:2))' * pg.sym(1:3,1:3,1) * exp(i2pi*dot(kpt,[+0.00000, +0.00000, +2.03524]));
H(4:6,1:3) = H(4:6,1:3) + pg.sym(4:6,4:6,8)' * getV2(v(1:2))' * pg.sym(1:3,1:3,8) * exp(i2pi*dot(kpt,[+0.00000, -2.03524, +0.00000]));
H(4:6,1:3) = H(4:6,1:3) + pg.sym(4:6,4:6,7)' * getV2(v(1:2))' * pg.sym(1:3,1:3,7) * exp(i2pi*dot(kpt,[+2.03524, +0.00000, +0.00000]));
H(4:6,1:3) = H(4:6,1:3) + pg.sym(4:6,4:6,9)' * getV2(v(1:2))' * pg.sym(1:3,1:3,9) * exp(i2pi*dot(kpt,[-2.03524, +0.00000, +0.00000]));
H(4:6,1:3) = H(4:6,1:3) + pg.sym(4:6,4:6,5)' * getV2(v(1:2))' * pg.sym(1:3,1:3,5) * exp(i2pi*dot(kpt,[+0.00000, +2.03524, +0.00000]));
H(4:6,1:3) = H(4:6,1:3) + pg.sym(4:6,4:6,2)' * getV2(v(1:2))' * pg.sym(1:3,1:3,2) * exp(i2pi*dot(kpt,[+0.00000, +0.00000, -2.03524]));
% irreducible shell 3
H(4:6,4:6) = H(4:6,4:6) + pg.sym(4:6,4:6,1)' * getV3(v(2:2)) * pg.sym(4:6,4:6,1) * exp(i2pi*dot(kpt,[+0.00000, +0.00000, +0.00000]));
end
