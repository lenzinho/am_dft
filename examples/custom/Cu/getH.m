function [H] = getH(pg,v,kpt)
i2pi = 2*sqrt(-1)*pi;
H(1:16,1:16) = 0;
% irreducible shell 1
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,1)' * getV1(v(1:8)) * pg.sym(1:16,1:16,1) * exp(i2pi*dot(kpt,[+0.00000, +0.00000, +0.00000]));
% irreducible shell 2
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,1)' * getV2(v(8:51)) * pg.sym(1:16,1:16,1) * exp(i2pi*dot(kpt,[+0.00000, -1.80820, +1.80820]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,13)' * getV2(v(8:51)) * pg.sym(1:16,1:16,13) * exp(i2pi*dot(kpt,[+1.80820, +0.00000, +1.80820]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,17)' * getV2(v(8:51)) * pg.sym(1:16,1:16,17) * exp(i2pi*dot(kpt,[-1.80820, +0.00000, +1.80820]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,4)' * getV2(v(8:51)) * pg.sym(1:16,1:16,4) * exp(i2pi*dot(kpt,[+0.00000, +1.80820, +1.80820]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,11)' * getV2(v(8:51)) * pg.sym(1:16,1:16,11) * exp(i2pi*dot(kpt,[+1.80820, -1.80820, +0.00000]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,18)' * getV2(v(8:51)) * pg.sym(1:16,1:16,18) * exp(i2pi*dot(kpt,[-1.80820, -1.80820, +0.00000]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,7)' * getV2(v(8:51)) * pg.sym(1:16,1:16,7) * exp(i2pi*dot(kpt,[+1.80820, +1.80820, +0.00000]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,9)' * getV2(v(8:51)) * pg.sym(1:16,1:16,9) * exp(i2pi*dot(kpt,[-1.80820, +1.80820, +0.00000]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,2)' * getV2(v(8:51)) * pg.sym(1:16,1:16,2) * exp(i2pi*dot(kpt,[+0.00000, -1.80820, -1.80820]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,6)' * getV2(v(8:51)) * pg.sym(1:16,1:16,6) * exp(i2pi*dot(kpt,[+1.80820, +0.00000, -1.80820]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,10)' * getV2(v(8:51)) * pg.sym(1:16,1:16,10) * exp(i2pi*dot(kpt,[-1.80820, +0.00000, -1.80820]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,3)' * getV2(v(8:51)) * pg.sym(1:16,1:16,3) * exp(i2pi*dot(kpt,[+0.00000, +1.80820, -1.80820]));
% irreducible shell 3
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,1)' * getV3(v(51:76)) * pg.sym(1:16,1:16,1) * exp(i2pi*dot(kpt,[+0.00000, +0.00000, +3.61641]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,8)' * getV3(v(51:76)) * pg.sym(1:16,1:16,8) * exp(i2pi*dot(kpt,[+0.00000, -3.61641, +0.00000]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,7)' * getV3(v(51:76)) * pg.sym(1:16,1:16,7) * exp(i2pi*dot(kpt,[+3.61641, +0.00000, +0.00000]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,9)' * getV3(v(51:76)) * pg.sym(1:16,1:16,9) * exp(i2pi*dot(kpt,[-3.61641, +0.00000, +0.00000]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,5)' * getV3(v(51:76)) * pg.sym(1:16,1:16,5) * exp(i2pi*dot(kpt,[+0.00000, +3.61641, +0.00000]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,2)' * getV3(v(51:76)) * pg.sym(1:16,1:16,2) * exp(i2pi*dot(kpt,[+0.00000, +0.00000, -3.61641]));
% irreducible shell 4
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,1)' * getV4(v(76:151)) * pg.sym(1:16,1:16,1) * exp(i2pi*dot(kpt,[-1.80820, -1.80820, +3.61641]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,4)' * getV4(v(76:151)) * pg.sym(1:16,1:16,4) * exp(i2pi*dot(kpt,[+1.80820, +1.80820, +3.61641]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,21)' * getV4(v(76:151)) * pg.sym(1:16,1:16,21) * exp(i2pi*dot(kpt,[+1.80820, -1.80820, +3.61641]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,20)' * getV4(v(76:151)) * pg.sym(1:16,1:16,20) * exp(i2pi*dot(kpt,[-1.80820, +1.80820, +3.61641]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,18)' * getV4(v(76:151)) * pg.sym(1:16,1:16,18) * exp(i2pi*dot(kpt,[-1.80820, -3.61641, +1.80820]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,17)' * getV4(v(76:151)) * pg.sym(1:16,1:16,17) * exp(i2pi*dot(kpt,[-3.61641, -1.80820, +1.80820]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,13)' * getV4(v(76:151)) * pg.sym(1:16,1:16,13) * exp(i2pi*dot(kpt,[+3.61641, +1.80820, +1.80820]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,15)' * getV4(v(76:151)) * pg.sym(1:16,1:16,15) * exp(i2pi*dot(kpt,[+1.80820, +3.61641, +1.80820]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,8)' * getV4(v(76:151)) * pg.sym(1:16,1:16,8) * exp(i2pi*dot(kpt,[+1.80820, -3.61641, +1.80820]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,23)' * getV4(v(76:151)) * pg.sym(1:16,1:16,23) * exp(i2pi*dot(kpt,[+3.61641, -1.80820, +1.80820]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,9)' * getV4(v(76:151)) * pg.sym(1:16,1:16,9) * exp(i2pi*dot(kpt,[-3.61641, +1.80820, +1.80820]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,24)' * getV4(v(76:151)) * pg.sym(1:16,1:16,24) * exp(i2pi*dot(kpt,[-1.80820, +3.61641, +1.80820]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,11)' * getV4(v(76:151)) * pg.sym(1:16,1:16,11) * exp(i2pi*dot(kpt,[+1.80820, -3.61641, -1.80820]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,16)' * getV4(v(76:151)) * pg.sym(1:16,1:16,16) * exp(i2pi*dot(kpt,[+3.61641, -1.80820, -1.80820]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,12)' * getV4(v(76:151)) * pg.sym(1:16,1:16,12) * exp(i2pi*dot(kpt,[-3.61641, +1.80820, -1.80820]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,14)' * getV4(v(76:151)) * pg.sym(1:16,1:16,14) * exp(i2pi*dot(kpt,[-1.80820, +3.61641, -1.80820]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,22)' * getV4(v(76:151)) * pg.sym(1:16,1:16,22) * exp(i2pi*dot(kpt,[-1.80820, -3.61641, -1.80820]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,19)' * getV4(v(76:151)) * pg.sym(1:16,1:16,19) * exp(i2pi*dot(kpt,[-3.61641, -1.80820, -1.80820]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,7)' * getV4(v(76:151)) * pg.sym(1:16,1:16,7) * exp(i2pi*dot(kpt,[+3.61641, +1.80820, -1.80820]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,5)' * getV4(v(76:151)) * pg.sym(1:16,1:16,5) * exp(i2pi*dot(kpt,[+1.80820, +3.61641, -1.80820]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,2)' * getV4(v(76:151)) * pg.sym(1:16,1:16,2) * exp(i2pi*dot(kpt,[+1.80820, -1.80820, -3.61641]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,3)' * getV4(v(76:151)) * pg.sym(1:16,1:16,3) * exp(i2pi*dot(kpt,[-1.80820, +1.80820, -3.61641]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,10)' * getV4(v(76:151)) * pg.sym(1:16,1:16,10) * exp(i2pi*dot(kpt,[-1.80820, -1.80820, -3.61641]));
H(1:16,1:16) = H(1:16,1:16) + pg.sym(1:16,1:16,6)' * getV4(v(76:151)) * pg.sym(1:16,1:16,6) * exp(i2pi*dot(kpt,[+1.80820, +1.80820, -3.61641]));
end
