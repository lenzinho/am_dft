function [H] = getH(pg,v,kpt)
i2pi = 2*sqrt(-1)*pi;
H(1:2,1:2) = 0;
% irreducible shell 1
H(1:1,1:1) = H(1:1,1:1) + pg.sym(1:1,1:1,1)' * getV1(v(1:1)) * pg.sym(1:1,1:1,1) * exp(i2pi*dot(kpt,[+0.00000, +0.00000, +0.00000]));
% irreducible shell 2
H(1:1,2:2) = H(1:1,2:2) + pg.sym(1:1,1:1,1)' * getV2(v(1:1)) * pg.sym(2:2,2:2,1) * exp(i2pi*dot(kpt,[+0.00000, +0.00000, +2.03558]));
H(1:1,2:2) = H(1:1,2:2) + pg.sym(1:1,1:1,8)' * getV2(v(1:1)) * pg.sym(2:2,2:2,8) * exp(i2pi*dot(kpt,[+0.00000, -2.03558, +0.00000]));
H(1:1,2:2) = H(1:1,2:2) + pg.sym(1:1,1:1,7)' * getV2(v(1:1)) * pg.sym(2:2,2:2,7) * exp(i2pi*dot(kpt,[+2.03558, +0.00000, +0.00000]));
H(1:1,2:2) = H(1:1,2:2) + pg.sym(1:1,1:1,9)' * getV2(v(1:1)) * pg.sym(2:2,2:2,9) * exp(i2pi*dot(kpt,[-2.03558, +0.00000, +0.00000]));
H(1:1,2:2) = H(1:1,2:2) + pg.sym(1:1,1:1,5)' * getV2(v(1:1)) * pg.sym(2:2,2:2,5) * exp(i2pi*dot(kpt,[+0.00000, +2.03558, +0.00000]));
H(1:1,2:2) = H(1:1,2:2) + pg.sym(1:1,1:1,2)' * getV2(v(1:1)) * pg.sym(2:2,2:2,2) * exp(i2pi*dot(kpt,[+0.00000, +0.00000, -2.03558]));
% irreducible shell 2
H(2:2,1:1) = H(2:2,1:1) + pg.sym(2:2,2:2,1)' * getV2(v(1:1))' * pg.sym(1:1,1:1,1) * exp(i2pi*dot(kpt,[+0.00000, +0.00000, +2.03558]));
H(2:2,1:1) = H(2:2,1:1) + pg.sym(2:2,2:2,8)' * getV2(v(1:1))' * pg.sym(1:1,1:1,8) * exp(i2pi*dot(kpt,[+0.00000, -2.03558, +0.00000]));
H(2:2,1:1) = H(2:2,1:1) + pg.sym(2:2,2:2,7)' * getV2(v(1:1))' * pg.sym(1:1,1:1,7) * exp(i2pi*dot(kpt,[+2.03558, +0.00000, +0.00000]));
H(2:2,1:1) = H(2:2,1:1) + pg.sym(2:2,2:2,9)' * getV2(v(1:1))' * pg.sym(1:1,1:1,9) * exp(i2pi*dot(kpt,[-2.03558, +0.00000, +0.00000]));
H(2:2,1:1) = H(2:2,1:1) + pg.sym(2:2,2:2,5)' * getV2(v(1:1))' * pg.sym(1:1,1:1,5) * exp(i2pi*dot(kpt,[+0.00000, +2.03558, +0.00000]));
H(2:2,1:1) = H(2:2,1:1) + pg.sym(2:2,2:2,2)' * getV2(v(1:1))' * pg.sym(1:1,1:1,2) * exp(i2pi*dot(kpt,[+0.00000, +0.00000, -2.03558]));
% irreducible shell 3
H(2:2,2:2) = H(2:2,2:2) + pg.sym(2:2,2:2,1)' * getV3(v(1:1)) * pg.sym(2:2,2:2,1) * exp(i2pi*dot(kpt,[+0.00000, +0.00000, +0.00000]));
end
